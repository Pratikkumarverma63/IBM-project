<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Profile ‚Ä¢ Pure Social Spark</title>

<style>
:root {
  --bg:#f4f6fb;
  --card:#fff;
  --text:#111;
  --primary:#6366f1;
  --secondary:#8b5cf6;
  --border:#e5e7eb;
  --hover:#f3f4f6;
  --success:#10b981;
  --danger:#ef4444;
}
body.dark {
  --bg:#0f172a;
  --card:#1e293b;
  --text:#f8fafc;
  --border:#334155;
  --hover:#334155;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:background 0.3s,color 0.3s;
}

/* Header */
header{
  position:sticky;
  top:0;
  background:var(--card);
  padding:12px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid var(--border);
  z-index:100;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);
  backdrop-filter:blur(10px);
}
header .logo{
  font-size:24px;
  font-weight:700;
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  cursor:pointer;
  text-decoration:none;
}
header .nav-actions{
  display:flex;
  gap:12px;
  align-items:center;
}
header .nav-icon{
  font-size:20px;
  cursor:pointer;
  padding:8px;
  border-radius:50%;
  transition:background 0.2s;
}
header .nav-icon:hover{
  background:var(--hover);
}

/* Container */
.container{
  max-width:1200px;
  margin:0 auto;
  padding:32px 24px;
}

/* Profile Header */
.profile-header{
  background:var(--card);
  border-radius:20px;
  padding:40px;
  margin-bottom:32px;
  box-shadow:0 4px 20px rgba(0,0,0,0.08);
  position:relative;
  overflow:hidden;
}
.profile-header::before{
  content:"";
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:120px;
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  opacity:0.1;
  z-index:0;
}
.profile-content{
  position:relative;
  z-index:1;
  display:flex;
  gap:40px;
  align-items:flex-start;
}
.profile-pic-wrapper{
  position:relative;
  flex-shrink:0;
}
.profile-pic{
  width:150px;
  height:150px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid var(--card);
  box-shadow:0 4px 20px rgba(0,0,0,0.15);
  cursor:pointer;
  transition:transform 0.3s;
}
.profile-pic:hover{
  transform:scale(1.05);
}
.edit-profile-btn{
  position:absolute;
  bottom:8px;
  right:8px;
  width:40px;
  height:40px;
  border-radius:50%;
  background:var(--primary);
  color:#fff;
  border:3px solid var(--card);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-size:18px;
  box-shadow:0 2px 10px rgba(0,0,0,0.2);
  transition:all 0.2s;
}
.edit-profile-btn:hover{
  background:var(--secondary);
  transform:scale(1.1);
}
.profile-info{
  flex:1;
  min-width:0;
}
.profile-top{
  display:flex;
  align-items:center;
  gap:20px;
  margin-bottom:20px;
  flex-wrap:wrap;
}
.profile-name{
  font-size:32px;
  font-weight:700;
  margin:0;
  color:var(--text);
}
.profile-username{
  font-size:18px;
  color:#6b7280;
  font-weight:400;
  margin-top:4px;
}
.profile-actions{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
.btn-primary{
  background:var(--primary);
  color:#fff;
  border:none;
  padding:10px 24px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  font-size:14px;
}
.btn-primary:hover{
  background:var(--secondary);
  transform:translateY(-2px);
  box-shadow:0 4px 12px rgba(99,102,241,0.4);
}
.btn-secondary{
  background:var(--hover);
  color:var(--text);
  border:1px solid var(--border);
  padding:10px 24px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  font-size:14px;
}
.btn-secondary:hover{
  background:var(--border);
}
.btn-outline{
  background:transparent;
  color:var(--text);
  border:1px solid var(--border);
  padding:10px 24px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  font-size:14px;
}
.btn-outline:hover{
  background:var(--hover);
  border-color:var(--primary);
}
.profile-stats{
  display:flex;
  gap:32px;
  margin:24px 0;
  padding:24px 0;
  border-top:1px solid var(--border);
  border-bottom:1px solid var(--border);
}
.stat-item{
  display:flex;
  flex-direction:column;
  cursor:pointer;
  transition:color 0.2s;
}
.stat-item:hover .stat-value{
  color:var(--primary);
}
.stat-value{
  font-size:24px;
  font-weight:700;
  color:var(--text);
  transition:color 0.2s;
}
.stat-label{
  font-size:14px;
  color:#6b7280;
  margin-top:4px;
}
.profile-bio{
  margin-top:20px;
}
.bio-name{
  font-size:16px;
  font-weight:600;
  margin-bottom:8px;
  color:var(--text);
}
.bio-text{
  font-size:15px;
  line-height:1.6;
  color:var(--text);
  opacity:0.9;
  max-width:600px;
}

/* Tabs */
.profile-tabs{
  background:var(--card);
  border-radius:16px;
  padding:8px;
  margin-bottom:32px;
  display:flex;
  gap:8px;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);
  overflow-x:auto;
}
.profile-tabs::-webkit-scrollbar{
  display:none;
}
.tab-btn{
  flex:1;
  padding:12px 24px;
  border:none;
  background:transparent;
  color:#6b7280;
  font-weight:600;
  font-size:15px;
  cursor:pointer;
  border-radius:10px;
  transition:all 0.2s;
  white-space:nowrap;
  position:relative;
}
.tab-btn:hover{
  background:var(--hover);
  color:var(--text);
}
.tab-btn.active{
  background:var(--primary);
  color:#fff;
}
.tab-btn.active::after{
  content:"";
  position:absolute;
  bottom:-2px;
  left:50%;
  transform:translateX(-50%);
  width:40px;
  height:3px;
  background:var(--primary);
  border-radius:2px;
}

/* Posts Grid */
.posts-container{
  min-height:400px;
}
.posts-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:20px;
  margin-bottom:32px;
}
.post-item{
  position:relative;
  aspect-ratio:1;
  border-radius:12px;
  overflow:hidden;
  cursor:pointer;
  background:var(--card);
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  transition:all 0.3s;
}
.post-item:hover{
  transform:translateY(-4px);
  box-shadow:0 8px 24px rgba(0,0,0,0.15);
}
.post-item img{
  width:100%;
  height:100%;
  object-fit:cover;
  transition:transform 0.3s;
}
.post-item:hover img{
  transform:scale(1.1);
}
.post-overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:flex;
  align-items:center;
  justify-content:center;
  gap:24px;
  opacity:0;
  transition:opacity 0.3s;
  color:#fff;
  font-weight:600;
  font-size:16px;
}
.post-item:hover .post-overlay{
  opacity:1;
}
.post-stat{
  display:flex;
  align-items:center;
  gap:8px;
}

/* Empty State */
.empty-state{
  text-align:center;
  padding:80px 20px;
  background:var(--card);
  border-radius:16px;
}
.empty-icon{
  font-size:80px;
  margin-bottom:20px;
  opacity:0.5;
}
.empty-title{
  font-size:24px;
  font-weight:600;
  margin-bottom:12px;
  color:var(--text);
}
.empty-text{
  font-size:16px;
  color:#6b7280;
  max-width:400px;
  margin:0 auto;
}

/* Edit Modal */
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
  backdrop-filter:blur(4px);
}
.modal-overlay.show{
  display:flex;
}
.modal{
  background:var(--card);
  border-radius:20px;
  padding:32px;
  max-width:500px;
  width:90%;
  max-height:90vh;
  overflow-y:auto;
  box-shadow:0 20px 60px rgba(0,0,0,0.3);
  animation:modalSlideIn 0.3s ease;
}
@keyframes modalSlideIn{
  from{
    opacity:0;
    transform:translateY(-20px);
  }
  to{
    opacity:1;
    transform:translateY(0);
  }
}
.modal-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:24px;
  padding-bottom:16px;
  border-bottom:1px solid var(--border);
}
.modal-title{
  font-size:24px;
  font-weight:700;
  color:var(--text);
}
.modal-close{
  background:none;
  border:none;
  font-size:24px;
  cursor:pointer;
  color:var(--text);
  padding:4px;
  border-radius:50%;
  transition:background 0.2s;
}
.modal-close:hover{
  background:var(--hover);
}
.modal-body{
  display:flex;
  flex-direction:column;
  gap:20px;
}
.form-group{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.form-label{
  font-size:14px;
  font-weight:600;
  color:var(--text);
}
.form-input{
  padding:12px;
  border:1px solid var(--border);
  border-radius:10px;
  background:var(--bg);
  color:var(--text);
  font-size:15px;
  transition:border 0.2s;
}
.form-input:focus{
  outline:none;
  border-color:var(--primary);
}
.form-textarea{
  min-height:100px;
  resize:vertical;
}
.modal-actions{
  display:flex;
  gap:12px;
  justify-content:flex-end;
  margin-top:8px;
}
.btn-cancel{
  background:var(--hover);
  color:var(--text);
}
.btn-save{
  background:var(--primary);
  color:#fff;
}

/* Toast */
.toast{
  position:fixed;
  bottom:24px;
  right:24px;
  background:#1f2937;
  color:#fff;
  padding:16px 24px;
  border-radius:12px;
  opacity:0;
  transform:translateY(20px);
  transition:all 0.3s;
  box-shadow:0 4px 16px rgba(0,0,0,0.2);
  z-index:1001;
}
.toast.show{
  opacity:1;
  transform:translateY(0);
}

/* Responsive */
@media(max-width:968px){
  .profile-content{
    flex-direction:column;
    align-items:center;
    text-align:center;
  }
  .profile-top{
    justify-content:center;
  }
  .profile-stats{
    justify-content:center;
  }
  .posts-grid{
    grid-template-columns:repeat(2,1fr);
    gap:12px;
  }
}
@media(max-width:640px){
  .container{padding:16px 12px}
  .profile-header{padding:24px 20px}
  .posts-grid{
    grid-template-columns:1fr;
  }
  .profile-tabs{
    overflow-x:auto;
  }
  .tab-btn{
    padding:10px 16px;
    font-size:14px;
  }
}
</style>
</head>

<body>

<header>
  <a href="index.html" class="logo">Pure Social Spark</a>
  <div class="nav-actions">
    <span class="nav-icon" onclick="window.location.href='index.html'">üè†</span>
    <span class="nav-icon" onclick="toggleDark()">üåô</span>
  </div>
</header>

<div class="container">
  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-content">
      <div class="profile-pic-wrapper">
        <img id="profileImage" class="profile-pic" src="https://i.pravatar.cc/150?img=1" alt="Profile">
        <label for="imageUpload" class="edit-profile-btn">‚úèÔ∏è</label>
        <input type="file" id="imageUpload" accept="image/*" hidden>
      </div>

      <div class="profile-info">
        <div class="profile-top">
          <div>
            <h1 class="profile-name" id="profileName">Guest User</h1>
            <p class="profile-username" id="profileUsername">@guest_user</p>
          </div>
          <div class="profile-actions">
            <button class="btn-primary" onclick="openEditModal()">Edit Profile</button>
            <button class="btn-secondary" onclick="shareProfile()">Share</button>
            <button class="btn-outline" onclick="window.location.href='index.html'">‚Üê Back</button>
          </div>
        </div>

        <div class="profile-stats">
          <div class="stat-item" onclick="showPosts()">
            <span class="stat-value" id="postsCount">0</span>
            <span class="stat-label">Posts</span>
          </div>
          <div class="stat-item" onclick="showFollowers()">
            <span class="stat-value" id="followersCount">0</span>
            <span class="stat-label">Followers</span>
          </div>
          <div class="stat-item" onclick="showFollowing()">
            <span class="stat-value" id="followingCount">0</span>
            <span class="stat-label">Following</span>
          </div>
        </div>

        <div class="profile-bio">
          <div class="bio-name" id="bioName">Full Name</div>
          <div class="bio-text" id="bioText">Bio description goes here. Share a little about yourself!</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="profile-tabs">
    <button class="tab-btn active" onclick="switchTab('posts',this)">
      üì∑ Posts
    </button>
    <button class="tab-btn" onclick="switchTab('saved',this)">
      üíæ Saved
    </button>
    <button class="tab-btn" onclick="switchTab('tagged',this)">
      üè∑Ô∏è Tagged
    </button>
  </div>

  <!-- Posts Container -->
  <div class="posts-container">
    <div id="postsGrid" class="posts-grid">
      <!-- Posts will be dynamically loaded -->
    </div>
    <div id="savedGrid" class="posts-grid" style="display:none">
      <!-- Saved posts -->
    </div>
    <div id="taggedGrid" class="posts-grid" style="display:none">
      <!-- Tagged posts -->
    </div>
  </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal-overlay" id="editModal">
  <div class="modal">
    <div class="modal-header">
      <h2 class="modal-title">Edit Profile</h2>
      <button class="modal-close" onclick="closeEditModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Full Name</label>
        <input type="text" class="form-input" id="editFullName" placeholder="Enter your full name">
      </div>
      <div class="form-group">
        <label class="form-label">Username</label>
        <input type="text" class="form-input" id="editUsername" placeholder="Enter username">
      </div>
      <div class="form-group">
        <label class="form-label">Bio</label>
        <textarea class="form-input form-textarea" id="editBio" placeholder="Tell us about yourself..."></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" class="form-input" id="editEmail" placeholder="Enter your email">
      </div>
      <div class="form-group">
        <label class="form-label">Website</label>
        <input type="url" class="form-input" id="editWebsite" placeholder="https://yourwebsite.com">
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn-secondary btn-cancel" onclick="closeEditModal()">Cancel</button>
      <button class="btn-primary btn-save" onclick="saveProfile()">Save Changes</button>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
/* ---------- HELPERS ---------- */
const qs=id=>document.getElementById(id);
const toast=msg=>{
  const t=qs("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),3000);
};

/* ---------- DATA ---------- */
let currentUser = JSON.parse(localStorage.getItem("currentUser") || localStorage.getItem("loggedInUser") || "null");
let posts = JSON.parse(localStorage.getItem("posts") || "[]");
let users = JSON.parse(localStorage.getItem("users") || "[]");

/* ---------- INIT USER ---------- */
if (!currentUser || currentUser === "null") {
  currentUser = {
    id: Date.now(),
    username: "Guest User",
    fullName: "Guest User",
    email: "",
    website: "",
    avatar: "https://i.pravatar.cc/150?img=1",
    bio: "Welcome to my profile!",
    followers: [],
    following: []
  };
}

/* ---------- LOAD PROFILE DATA ---------- */
function loadProfile() {
  // Load user posts
  const userPosts = posts.filter(p => p.userId === currentUser.id);
  
  // Update UI
  qs("profileName").textContent = currentUser.fullName || currentUser.username;
  qs("profileUsername").textContent = "@" + (currentUser.username || "guest_user").toLowerCase().replace(/\s+/g, "_");
  qs("bioName").textContent = currentUser.fullName || currentUser.username;
  qs("bioText").textContent = currentUser.bio || "No bio yet. Click 'Edit Profile' to add one!";
  qs("postsCount").textContent = userPosts.length;
  qs("followersCount").textContent = currentUser.followers?.length || 0;
  qs("followingCount").textContent = currentUser.following?.length || 0;
  
  if (currentUser.avatar) {
    qs("profileImage").src = currentUser.avatar;
  }
  
  // Load form data
  qs("editFullName").value = currentUser.fullName || currentUser.username;
  qs("editUsername").value = currentUser.username || "";
  qs("editBio").value = currentUser.bio || "";
  qs("editEmail").value = currentUser.email || "";
  qs("editWebsite").value = currentUser.website || "";
  
  // Render posts
  renderPosts(userPosts, "postsGrid");
}

/* ---------- RENDER POSTS ---------- */
function renderPosts(postsList, containerId) {
  const container = qs(containerId);
  if (postsList.length === 0) {
    container.innerHTML = `
      <div class="empty-state" style="grid-column:1/-1">
        <div class="empty-icon">üì∑</div>
        <div class="empty-title">No posts yet</div>
        <div class="empty-text">Start sharing your moments with the world!</div>
      </div>
    `;
    return;
  }
  
  container.innerHTML = postsList.map(post => `
    <div class="post-item" onclick="viewPost(${post.postId})">
      <img src="${post.image || 'https://picsum.photos/400/400?random=' + post.postId}" alt="Post">
      <div class="post-overlay">
        <div class="post-stat">‚ù§Ô∏è ${post.likes?.length || 0}</div>
        <div class="post-stat">üí¨ ${post.comments?.length || 0}</div>
      </div>
    </div>
  `).join("");
}

/* ---------- TABS ---------- */
function switchTab(tab, btn) {
  // Update active tab
  document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  
  // Show/hide grids
  qs("postsGrid").style.display = tab === "posts" ? "grid" : "none";
  qs("savedGrid").style.display = tab === "saved" ? "grid" : "none";
  qs("taggedGrid").style.display = tab === "tagged" ? "grid" : "none";
  
  // Load content for each tab
  if (tab === "posts") {
    const userPosts = posts.filter(p => p.userId === currentUser.id);
    renderPosts(userPosts, "postsGrid");
  } else if (tab === "saved") {
    const savedPosts = posts.filter(p => currentUser.savedPosts?.includes(p.postId));
    renderPosts(savedPosts, "savedGrid");
  } else if (tab === "tagged") {
    const taggedPosts = posts.filter(p => p.taggedUsers?.includes(currentUser.id));
    renderPosts(taggedPosts, "taggedGrid");
  }
}

/* ---------- MODAL ---------- */
function openEditModal() {
  qs("editModal").classList.add("show");
}
function closeEditModal() {
  qs("editModal").classList.remove("show");
}
function saveProfile() {
  const fullName = qs("editFullName").value.trim();
  const username = qs("editUsername").value.trim();
  const bio = qs("editBio").value.trim();
  const email = qs("editEmail").value.trim();
  const website = qs("editWebsite").value.trim();
  
  if (!username) {
    toast("‚ö†Ô∏è Username is required");
    return;
  }
  
  // Update user
  currentUser.fullName = fullName || username;
  currentUser.username = username;
  currentUser.bio = bio;
  currentUser.email = email;
  currentUser.website = website;
  
  // Update in users array
  const userIndex = users.findIndex(u => u.id === currentUser.id);
  if (userIndex >= 0) {
    users[userIndex] = { ...users[userIndex], ...currentUser };
  } else {
    users.push(currentUser);
  }
  
  // Save
  localStorage.setItem("currentUser", JSON.stringify(currentUser));
  localStorage.setItem("users", JSON.stringify(users));
  localStorage.setItem("loggedInUser", JSON.stringify(currentUser));
  
  // Reload profile
  loadProfile();
  closeEditModal();
  toast("‚úÖ Profile updated successfully!");
}

/* ---------- PROFILE IMAGE UPLOAD ---------- */
qs("imageUpload").addEventListener("change", function(e) {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      currentUser.avatar = e.target.result;
      qs("profileImage").src = e.target.result;
      
      // Update in users array
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      if (userIndex >= 0) {
        users[userIndex].avatar = currentUser.avatar;
      }
      
      localStorage.setItem("currentUser", JSON.stringify(currentUser));
      localStorage.setItem("users", JSON.stringify(users));
      localStorage.setItem("loggedInUser", JSON.stringify(currentUser));
      toast("‚úÖ Profile picture updated!");
    };
    reader.readAsDataURL(file);
  }
});

/* ---------- ACTIONS ---------- */
function viewPost(postId) {
  toast("Viewing post...");
  // Can navigate to post detail page or show modal
}
function shareProfile() {
  if (navigator.share) {
    navigator.share({
      title: `${currentUser.fullName || currentUser.username}'s Profile`,
      text: `Check out ${currentUser.fullName || currentUser.username} on Pure Social Spark!`,
      url: window.location.href
    });
  } else {
    navigator.clipboard.writeText(window.location.href);
    toast("üìã Profile link copied to clipboard!");
  }
}
function showPosts() {
  document.querySelector('.tab-btn').click();
}
function showFollowers() {
  toast("Followers list coming soon!");
}
function showFollowing() {
  toast("Following list coming soon!");
}
function toggleDark() {
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode", document.body.classList.contains("dark"));
}

// Close modal on overlay click
qs("editModal").addEventListener("click", function(e) {
  if (e.target === this) {
    closeEditModal();
  }
});

/* ---------- INIT ---------- */
if (localStorage.getItem("darkMode") === "true") {
  document.body.classList.add("dark");
}
loadProfile();
</script>

</body>
</html>
